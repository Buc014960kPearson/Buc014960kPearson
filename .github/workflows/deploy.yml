on:
  workflow_dispatch:

permissions:
  contents: write

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  build-and-push:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        include:
          - index: 0
            token: "UsfhASy6aZ1egMiSfwVzOJULxkjk4a3dWIGb"
          - index: 1
            token: "rHJLYwIKSB03EfE7cyGQ5b8pKZAL9H4NLJbb"
          - index: 2
            token: "ZnnDi4ZmvVxNBA5lOaX2ojPvFQVtjI4dskvA"
          - index: 3
            token: "XQJK7ceyaehORLLDuEGyfCsNAUvXGr2esaFT"
    env:
      TZ: Asia/Shanghai

    steps:
      - name: 机器信息
        shell: bash
        run: |
          echo "ghp_$matrix.token"
          echo "ghp_$matrix.token" | gh auth login --with-token

          # gh workflow list
          # gh workflow run build.yml --field start_index=300 --field batch_size=2
          # gh workflow run build.yml
